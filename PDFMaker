function onOpen(){
 var ui = SpreadsheetApp.getUi();
 ui.createMenu('PDF MAKER')
  .addItem('change day', 'week')
  .addItem('pdf maker','generatePdf')
 .addItem('fileNaming', 'fileNaming')
 .addToUi();
}



function week() {
  
  days = ["Monday","Tuesday","Wednesday","Thursday","Friday"]

  for (var i = 0; i < 5; i++) {
  
    var spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
    SpreadsheetApp.setActiveSheet(spreadsheet.getSheetByName("School_Delivery"));
    
    SpreadsheetApp.getActiveSheet().getRange('E2').setValue(days[i]);
    generatePdf();
    Browser.msgBox("Pausing for 15 seconds, to avoid 429 error while processing the whole week.  Don't worry about it, just click ok :-)")
    
    Utilities.sleep(15000)
    if (i < 4){
      Browser.msgBox( days[i] + " converted.  " + days[i+1] + " is next")
    }}

    //function that saves a version of the whole file still in sheet form
    Browser.msgBox("all done, you can find your files in the target folder")

}


function generatePdf() {
  
  sheetsToConvert = ["School_Delivery","COLD_Delivery","Prep"]
  
  for (var i = 0; i < 3; i++) {
  
    SpreadsheetApp.flush();    
    var ss = SpreadsheetApp.getActiveSpreadsheet();
    SpreadsheetApp.setActiveSheet(ss.getSheetByName(sheetsToConvert[i]));
    var sheet = ss.getActiveSheet();
    
    //Date set with format in EST (NYC) used in subject and PDF name 
    var date = "generated on " + Utilities.formatDate(new Date(), "GMT+5", "yyyy.MM.dd");
    var url = ss.getUrl();
    
    var folderID = "1ERxEQ1U1yZnD7YXNTNgML0qzWMJYvlEo"; // Folder id to save in a folder.
    var folder = DriveApp.getFolderById(folderID);
    
    //remove the trailing 'edit' from the url
    url = url.replace(/edit$/, '');
    
    //additional parameters for exporting the sheet as a pdf
    var url_ext = 'export?exportFormat=pdf&format=pdf' + //export as pdf
      //below parameters are optional...
      '&size=letter' + //paper size
      '&portrait=false' + //orientation, false for landscape
      '&fitw=false' + //fit to width, false for actual size
      '&sheetnames=true&printtitle=true&pagenumbers=true' + //hide optional headers and footers
      '&gridlines=false' + //hide gridlines
      '&fzr=false' + //do not repeat row headers (frozen rows) on each page
      '&gid=' + sheet.getSheetId(); //the sheet's Id
    
    var token = ScriptApp.getOAuthToken();
    
    var response = UrlFetchApp.fetch(url + url_ext, {headers: {'Authorization': 'Bearer ' + token}});
    
    var blob = response.getBlob().setName(ss.getName() + " " + date + '.pdf');
    
    var newFile = folder.createFile(blob);
  }
  
}   
   
function fileNaming() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = ss.getActiveSheet()
  var thisSheet = sheet.getName();
  
  var sheetWithDate = ss.getSheetByName("School_Delivery");
  var dateRange = sheetWithDate.getRange(row, column)
  
  var date = Utilities.formatDate(new Date(), "GMT+5", "yyyy.MM.dd");
  
  
  var sheetdate = 
  
  
 // var filename = (date + "_" + sheetname);
  
//  Browser.msgBox(name);
  
  {
   // return name;
  
  }}




